{
  "metadata": {
    "id": "builtin-tools-policy",
    "name": "ビルトインツールポリシー",
    "version": "1.0.0",
    "status": "active",
    "description": "Claude Codeビルトインツール（Bash/Read/Write/Edit/Glob/Grep）のセキュリティポリシー",
    "createdAt": "2025-12-17T00:00:00.000Z",
    "lastModified": "2025-12-17T00:00:00.000Z",
    "createdBy": "aegis-system",
    "lastModifiedBy": "aegis-system",
    "tags": [
      "builtin-tools",
      "bash",
      "file-operations",
      "security"
    ],
    "priority": 150
  },
  "policy": "【ビルトインツールポリシー】\n\n## 基本原則\n- ビルトインツール（Bash、Read、Write、Edit、Glob、Grep）の使用はAEGISポリシー制御下で許可\n- セキュリティリスクの高い操作は制限または監査強化\n- すべてのファイル操作とコマンド実行は監査ログに記録\n\n## Bashコマンド制限\n- **禁止コマンド**: \n  - システム破壊: rm -rf /、mkfs、dd\n  - 権限昇格: sudo、su（明示的な承認がない限り）\n  - ネットワーク経由のコード実行: curl | bash、wget | sh\n  - Fork bomb: :(){ :|:& };:\n- **監査必須コマンド**:\n  - ネットワークアクセス: curl、wget、ssh、scp\n  - パッケージ管理: apt、yum、brew、npm install\n  - システム設定変更: systemctl、service\n- **許可される操作**:\n  - 開発関連コマンド: git、npm、node、python\n  - 情報取得コマンド: ls、cat、grep、find\n  - ビルド操作: make、cmake、cargo、go build\n\n## ファイル操作制限\n- **書き込み禁止ディレクトリ**:\n  - /etc（システム設定）\n  - /sys、/proc（カーネル領域）\n  - /dev（デバイスファイル）\n  - /boot（起動ファイル）\n- **読み取り制限ファイル**:\n  - .env、.key、credentials.json（機密情報）\n  - /etc/shadow、/etc/passwd（認証情報）\n  - id_rsa、*.pem（秘密鍵）\n- **許可される操作**:\n  - ユーザーホームディレクトリ内のファイル読み書き\n  - プロジェクトディレクトリ内の通常ファイル操作\n  - 一時ディレクトリ（/tmp）への書き込み\n\n## ファイル検索（Glob/Grep）\n- **許可**:\n  - プロジェクトディレクトリ内の検索\n  - テキストファイルの内容検索\n  - コード検索・リファクタリング支援\n- **制限**:\n  - システムディレクトリの包括的検索は制限\n  - 大量ファイル検索は結果数制限あり\n  - バイナリファイルの検索は除外\n\n## 制約事項\n- **実行時間制限**: 長時間実行コマンドはタイムアウト（デフォルト30秒）\n- **ファイルサイズ制限**: 大容量ファイル（>100MB）の操作は制限\n- **並行実行制限**: 同時実行数の制限によるリソース保護\n- **出力サイズ制限**: コマンド出力は最大10MBまで\n\n## 義務事項\n- **監査ログ**: すべてのツール呼び出しを記録\n  - 実行時刻、エージェント、コマンド/操作内容\n  - 実行結果（成功/失敗）\n  - 実行時間とリソース使用量\n- **セキュリティアラート**: 以下の場合は管理者に通知\n  - 危険なコマンドの試行\n  - システムディレクトリへの書き込み試行\n  - 機密ファイルへのアクセス試行\n  - 異常な頻度のツール使用\n- **コンプライアンス**: \n  - ファイル操作の履歴保持（30日間）\n  - セキュリティインシデントの詳細記録\n\n## 特別な許可\n- **開発ディレクトリ（~/Develop）**: より寛容なポリシー適用\n  - ビルドコマンドの制限緩和\n  - ファイル操作の制限緩和\n  - ただし監査ログは維持\n\n## 判定基準\n- **PERMIT（許可）**: \n  - 通常の開発作業に必要な操作\n  - セキュリティリスクが低い操作\n  - 制約条件を満たす操作\n- **DENY（拒否）**:\n  - 明示的に禁止されている操作\n  - システムの安定性を脅かす操作\n  - 機密情報へのアクセス\n- **INDETERMINATE（判定不能）**:\n  - ポリシーで明確に定義されていない新しい操作\n  - コンテキスト情報が不足している場合\n  - 人間の判断が必要な微妙なケース"
}
