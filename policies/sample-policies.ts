/**
 * AEGIS自然言語ポリシー集
 * 企業環境での実用的なポリシー例
 */

// 顧客データアクセスポリシー
export const CUSTOMER_DATA_POLICY = `
【顧客データアクセスポリシー】

■ 基本原則
- 顧客データは顧客サポート、営業支援、データ分析の正当な業務目的でのみアクセス可能
- アクセスは営業時間内（平日9:00-18:00、土曜9:00-15:00）を基本とする
- 適切なクリアランスレベル（standard以上）を持つ認証済みエージェントのみアクセス許可
- GDPR、個人情報保護法等の法的要件を厳守

■ 制限事項
- 外部エージェントや未認証エージェントのアクセスは全面禁止
- 個人情報（PII）の外部システムへの送信・共有は一切禁止
- 顧客データの長期間保存（90日超）は特別承認が必要
- 一度に大量データ（1000件超）へのアクセスは管理者承認必要
- VPN接続以外からの機密データアクセスは禁止

■ 必須対応事項
- 全ての顧客データアクセスは詳細ログに記録（アクセス者、時刻、データ内容、目的）
- データ処理完了後24時間以内に関係者・データ保護責任者へ通知
- アクセスしたデータは業務完了後30日以内に自動削除予約を設定
- 機密レベル「高」以上のデータは暗号化必須
- 異常なアクセスパターン検出時は即座にセキュリティチームへ自動通知

■ 緊急時対応
- システム障害・セキュリティインシデント対応時は時間外アクセスを許可
- ただし、緊急アクセスは必ず事後24時間以内に管理者へ詳細報告
- 緊急事態の定義：システムダウン、データ漏洩疑い、法的要請対応
`;

// メールアクセス制御ポリシー
export const EMAIL_ACCESS_POLICY = `
【メールアクセス制御ポリシー】

■ 許可条件
- 認証済みの業務用AIエージェントのみメール機能にアクセス可能
- メール送信は事前承認されたテンプレート・定型文のみ使用
- 添付ファイルは10MB以下、かつ承認済みファイル形式のみ
- 受信メールの自動処理は業務時間内のみ実行

■ 送信制限
- 社外への一括送信（50件以上）は事前承認が必要
- 機密情報含有の可能性があるメールは自動スキャン・承認プロセス必須
- 個人的な用途でのメール送受信は一切禁止
- 自動応答・不在応答の設定は管理者権限が必要

■ セキュリティ要件
- 全メール送受信の内容・相手先・添付ファイルをログ記録
- フィッシング・スパム疑いメールは自動隔離
- 不審なパターン（大量送信、機密用語検出、異常な送信先）は即座にアラート
- 週次でメール使用状況レポートを自動生成・管理者送付

■ 監査・コンプライアンス
- メール保存期間は法的要件に従い最低7年間
- eDiscovery対応のため全メールは検索可能な形式で保存
- 定期的な使用状況監査（月次）を実施
`;

// ファイルシステムアクセスポリシー
export const FILE_SYSTEM_POLICY = `
【ファイルシステムアクセス制御ポリシー】

■ 読み取り権限
- 公開フォルダ（/public/*, /shared/*）は全認証済みエージェントがアクセス可能
- 部署別作業フォルダ（/departments/*/）は対応部署のエージェントのみアクセス
- 個人フォルダ（/users/*/）は本人および直属上司のエージェントのみアクセス
- 機密フォルダ（/confidential/*, /restricted/*）は管理者権限および特別承認が必要

■ 書き込み制限
- システムフォルダ（/system/*, /config/*）への書き込みは管理者のみ
- 実行ファイル（.exe, .sh, .bat等）の作成・変更は管理者承認が必要
- 一時ファイルは作成から24時間後に自動削除
- ファイルサイズ制限：一般ファイル100MB、メディアファイル1GB

■ セキュリティ制御
- 重要ファイル（機密指定）の変更前は自動バックアップを実行
- 削除操作は30日間のゴミ箱保管（完全削除は管理者承認必要）
- 機密ファイルの操作は暗号化ログに記録
- ファイル共有は社内のみ、外部共有は特別承認必要

■ バージョン管理・監査
- 重要ファイルは自動バージョン管理（最大10世代保持）
- ファイルアクセス履歴は最低2年間保持
- 定期的なアクセス権限見直し（四半期ごと）
- 異常なファイル操作（大量削除、権限変更等）は即座にアラート
`;

// 高リスク操作ポリシー
export const HIGH_RISK_OPERATIONS_POLICY = `
【高リスク操作制御ポリシー】

■ 高リスク操作の定義
- データベースの構造変更（テーブル作成・削除・ALTER文等）
- 大量データの削除・更新（1000件以上）
- システム設定の変更
- ユーザー権限の付与・削除
- 外部システムとの接続・API呼び出し
- 暗号化キーの生成・管理

■ 承認要件
- 高リスク操作は必ず管理者の事前承認が必要
- 承認申請には業務理由・影響範囲・実行計画を明記
- 緊急時を除き、承認から実行まで最低4時間の待機期間
- 複数の管理者による承認が必要（クリティカル操作の場合）

■ 実行制御
- 高リスク操作は営業時間内のみ実行可能
- バックアップ完了確認後でないと実行不可
- 操作ログの詳細記録（実行者、時刻、対象、結果）
- 実行中のリアルタイム監視・異常検知

■ 事後対応
- 操作完了後1時間以内に結果報告書を作成
- 関係者への通知（成功・失敗問わず）
- 問題発生時の即座のロールバック準備
- 月次での高リスク操作レビュー実施
`;

// デフォルト制御ポリシー
export const DEFAULT_POLICY = `
【デフォルトアクセス制御ポリシー】

■ 基本方針
- 全てのアクセスは「最小権限の原則」に基づく
- 不明・未分類のリソースは慎重な判定を行う
- セキュリティとユーザビリティのバランスを重視
- 企業のコンプライアンス要件を最優先

■ 認証・認可
- 認証済みエージェントのみアクセス許可
- 適切な業務目的の明示が必要
- 定期的な権限見直し・更新
- 不正アクセス試行の自動検知・遮断

■ ログ・監査
- 全アクセス試行のログ記録必須
- 拒否されたアクセスの詳細分析
- 定期的なセキュリティ監査実施
- インシデント対応手順の整備

■ 継続的改善
- ポリシーの定期見直し（月次）
- ユーザーフィードバックの収集・反映
- 脅威情報に基づくポリシー更新
- AI判定精度の継続的向上
`;

// 営業時間外・緊急時ポリシー
export const AFTER_HOURS_POLICY = `
【営業時間外・緊急時アクセスポリシー】

■ 適用条件
- 平日18:00以降、土曜15:00以降、日曜・祝日全日
- 緊急事態（システム障害、セキュリティインシデント、法的要請対応）
- 海外対応・タイムゾーン調整が必要な業務

■ 制限事項
- 通常のデータ処理・分析業務は原則禁止
- 機密データへのアクセスはより厳格な承認が必要
- 大規模なシステム変更は緊急時以外禁止
- 複数システムにまたがる操作は事前計画必須

■ 承認・報告
- 営業時間外アクセスは管理者への事前連絡または事後報告必須
- 緊急時対応の場合は24時間以内の詳細報告
- アクセス理由・実施内容・結果の文書化
- 翌営業日の管理者レビュー必須

■ 追加監視
- 営業時間外は監視レベルを「高」に設定
- 異常なアクセスパターンの検知感度向上
- リアルタイムアラート機能の有効化
- セキュリティチームへの自動通知
`;

// エクスポート
export const SAMPLE_POLICIES = {
  'customer-data-policy': {
    name: 'customer-data-policy',
    description: '顧客データアクセス制御',
    policy: CUSTOMER_DATA_POLICY,
    tags: ['customer', 'personal-data', 'gdpr', 'privacy']
  },
  'email-access-policy': {
    name: 'email-access-policy',
    description: 'メールアクセス制御',
    policy: EMAIL_ACCESS_POLICY,
    tags: ['email', 'communication', 'security']
  },
  'file-system-policy': {
    name: 'file-system-policy',
    description: 'ファイルシステムアクセス制御',
    policy: FILE_SYSTEM_POLICY,
    tags: ['files', 'storage', 'permissions']
  },
  'high-risk-operations-policy': {
    name: 'high-risk-operations-policy',
    description: '高リスク操作制御',
    policy: HIGH_RISK_OPERATIONS_POLICY,
    tags: ['high-risk', 'critical', 'approval']
  },
  'default-policy': {
    name: 'default-policy',
    description: 'デフォルト制御ポリシー',
    policy: DEFAULT_POLICY,
    tags: ['default', 'general']
  },
  'after-hours-policy': {
    name: 'after-hours-policy',
    description: '営業時間外・緊急時ポリシー',
    policy: AFTER_HOURS_POLICY,
    tags: ['after-hours', 'emergency', 'time-based']
  }
};