# Web UI 使用方法

AEGISのWeb UIでは、ポリシー管理、監査ログの確認、リアルタイムモニタリングなどが行えます。

## 📋 アクセス方法

AEGISが起動している状態で、ブラウザから以下のURLにアクセスします：

- **ホームページ**: http://localhost:3000/
- **監査ダッシュボード**: http://localhost:3000/audit-dashboard.html
- **リクエストダッシュボード**: http://localhost:3000/request-dashboard.html
- **ポリシー管理UI**: http://localhost:3001/ (React版、別途起動が必要)

## 🏠 ホームページ

### 概要
AEGISの各機能へのナビゲーションハブです。

### 主な機能
- 各ダッシュボードへのクイックアクセス
- システムステータスの確認
- 基本的な統計情報の表示

## 📊 監査ダッシュボード

### 概要
アクセス統計と傾向を視覚的に確認できます。

### 主な機能

#### 1. リアルタイム統計
- **総リクエスト数**: 処理されたリクエストの合計
- **許可/拒否の割合**: 円グラフで視覚化
- **拒否率**: セキュリティ状況の指標

#### 2. 時系列グラフ
- 1時間ごとのアクセス推移
- 許可/拒否の傾向分析
- ピーク時間の特定

#### 3. エージェント別統計
- 各エージェントのアクセス頻度
- エージェントごとの許可/拒否率
- 異常なアクセスパターンの検出

#### 4. リソース別統計
- アクセスされたリソースのランキング
- リソースタイプ別の分析
- 機密リソースへのアクセス監視

#### 5. 拒否理由の分析
- よくある拒否理由のリスト
- ポリシー違反のパターン分析
- 改善ポイントの特定

### 使い方
1. ダッシュボードを開く
2. 期間フィルタで表示範囲を調整（デフォルト: 過去24時間）
3. 各グラフをクリックして詳細を確認
4. 「更新」ボタンで最新データを取得

## 🔍 リクエストダッシュボード

### 概要
個々のリクエストの詳細を確認・検索できます。

### 主な機能

#### 1. リクエスト一覧
各リクエストの以下の情報を表示：
- **タイムスタンプ**: リクエスト時刻
- **エージェント**: 実行元のエージェント名
- **アクション**: 実行されたアクション
- **リソース**: アクセス対象
- **判定結果**: PERMIT/DENY
- **リスクレベル**: 高/中/低

#### 2. 検索・フィルタ機能
- キーワード検索（エージェント名、リソース名など）
- 判定結果でフィルタ（許可のみ/拒否のみ）
- 期間指定
- リスクレベルでフィルタ

#### 3. 詳細表示
リクエストをクリックすると詳細モーダルが開き、以下を確認できます：
- 完全なコンテキスト情報
- 適用されたポリシー
- 判定理由の詳細
- 実行された制約・義務
- 処理時間

#### 4. エクスポート機能
- CSV形式でのエクスポート
- 監査レポートの生成
- フィルタ結果のみエクスポート可能

### 使い方
1. リクエストダッシュボードを開く
2. 必要に応じて検索・フィルタを設定
3. リクエストをクリックして詳細を確認
4. 異常なパターンがないか定期的にチェック

## 🎛️ ポリシー管理UI（React版）

### 起動方法
```bash
cd web
npm install
npm run dev
```

http://localhost:3001 でアクセス

### 主な機能

#### 1. ポリシー一覧
- 登録されているポリシーの表示
- ステータス（アクティブ/非アクティブ）の確認
- バージョン管理

#### 2. ポリシーエディタ
- 自然言語でポリシーを記述
- シンタックスハイライト
- リアルタイムバリデーション
- プレビュー機能

#### 3. ポリシーテスト
- 仮想的なリクエストでポリシーをテスト
- 判定結果の事前確認
- デバッグ情報の表示

#### 4. バージョン管理
- 変更履歴の確認
- 過去のバージョンへのロールバック
- 差分表示

### 使い方
1. ポリシー管理UIにアクセス
2. 「新規作成」でポリシーを追加
3. エディタで自然言語ポリシーを記述
4. 「テスト」で動作確認
5. 「保存」で適用

## 🔧 高度な機能

### カスタムダッシュボード
APIエンドポイントを使用して、独自のダッシュボードを作成できます：

```javascript
// 統計情報の取得
fetch('/api/audit/stats')
  .then(res => res.json())
  .then(data => {
    console.log('Total requests:', data.totalRequests);
    console.log('Deny rate:', data.denyRate);
  });

// リクエスト一覧の取得
fetch('/api/audit/requests?limit=50&offset=0')
  .then(res => res.json())
  .then(data => {
    console.log('Requests:', data.requests);
  });
```

### ウェブフック設定
特定のイベント（高リスクアクセス、連続拒否など）で通知を受け取る：

```json
{
  "webhooks": {
    "highRiskAccess": "https://your-webhook-url/high-risk",
    "policyViolation": "https://your-webhook-url/violation"
  }
}
```

## 📱 モバイル対応

Web UIはレスポンシブデザインで、モバイルデバイスからもアクセス可能です：

- タブレット: 全機能利用可能
- スマートフォン: 基本的な監視機能に最適化

## 🔒 セキュリティ設定

### アクセス制限
本番環境では、Web UIへのアクセスを制限することを推奨：

```nginx
# Nginx設定例
location / {
    allow 192.168.1.0/24;
    deny all;
    proxy_pass http://localhost:3000;
}
```

### 認証の追加
必要に応じて、Basic認証やOAuth2を追加：

```javascript
// 環境変数で認証を有効化
AUTH_ENABLED=true
AUTH_USERNAME=admin
AUTH_PASSWORD=secure-password
```

## 💡 活用のヒント

1. **定期的な確認**
   - 毎日1回はダッシュボードを確認
   - 異常なパターンを早期発見

2. **アラートの設定**
   - 拒否率が急上昇した場合の通知
   - 特定のリソースへの異常アクセス

3. **レポートの活用**
   - 週次/月次でレポートを生成
   - 経営層への報告に使用

4. **改善のサイクル**
   - 拒否理由を分析してポリシーを改善
   - ユーザビリティとセキュリティのバランス

## 📚 関連ドキュメント

- [ポリシー記述ガイド](./policy-writing.md) - 効果的なポリシーの作成
- [監視・ログ管理](../admin-guide/monitoring.md) - より詳細な監視設定
- [API リファレンス](../developer-guide/api-reference.md) - カスタム統合の開発