# 利用可能なツール一覧

AEGISを通じて制御される各種MCPツールのカタログです。各ツールのリスクレベルと推奨される制御方法を記載しています。

## 📁 ファイルシステム操作ツール

### filesystem__read_file
- **説明**: ファイルの内容を読み取る
- **リスクレベル**: 低
- **推奨制御**: 基本的なアクセスログ
- **使用例**: `README.mdの内容を読んでください`

### filesystem__read_multiple_files
- **説明**: 複数ファイルを一括で読み取る
- **リスクレベル**: 低〜中
- **推奨制御**: 大量ファイル読み取り時の警告
- **使用例**: `srcディレクトリ内の全JSファイルを確認`

### filesystem__write_file
- **説明**: ファイルの作成または上書き
- **リスクレベル**: 中
- **推奨制御**: 書き込み内容のログ、重要ファイルの保護
- **使用例**: `設定ファイルを更新してください`

### filesystem__create_directory
- **説明**: 新しいディレクトリを作成
- **リスクレベル**: 低〜中
- **推奨制御**: 作成場所の検証
- **使用例**: `プロジェクト用の新しいフォルダを作成`

### filesystem__list_directory
- **説明**: ディレクトリの内容を一覧表示
- **リスクレベル**: 低
- **推奨制御**: 基本的なアクセスログ
- **使用例**: `現在のディレクトリの内容を表示`

### filesystem__move_file
- **説明**: ファイルの移動またはリネーム
- **リスクレベル**: 中〜高
- **推奨制御**: 移動元と移動先の検証、重要ファイルの保護
- **使用例**: `oldname.txtをnewname.txtにリネーム`

### filesystem__search_files
- **説明**: ファイルをパターンで検索
- **リスクレベル**: 低
- **推奨制御**: 検索範囲の制限
- **使用例**: `*.pyファイルを検索してください`

### filesystem__get_file_info
- **説明**: ファイルのメタデータを取得
- **リスクレベル**: 低
- **推奨制御**: 基本的なアクセスログ
- **使用例**: `package.jsonの更新日時を確認`

### filesystem__list_allowed_directories
- **説明**: アクセス可能なディレクトリ一覧
- **リスクレベル**: 低
- **推奨制御**: なし（情報提供のみ）
- **使用例**: `アクセス可能なディレクトリを表示`

## ⚡ コード・コマンド実行ツール

### execution-server__exec_unix_command
- **説明**: Unixコマンドの実行
- **リスクレベル**: 高
- **推奨制御**: コマンドの検証、危険なコマンドのブロック、詳細ログ
- **注意事項**: rm, sudo, systemctl等の危険コマンドに注意
- **使用例**: `ls -la を実行`

### execution-server__exec_nodejs_code
- **説明**: Node.jsコードの実行
- **リスクレベル**: 高
- **推奨制御**: コードの静的解析、サンドボックス実行
- **注意事項**: ファイルシステムやネットワークアクセスに注意
- **使用例**: `簡単な計算スクリプトを実行`

### execution-server__get_server_info
- **説明**: 実行環境の情報取得
- **リスクレベル**: 低
- **推奨制御**: 基本的なアクセスログ
- **使用例**: `サーバーの環境情報を確認`

## 🛠️ Claude Code 内蔵ツール

### Agent
- **説明**: 再帰的なタスク実行
- **リスクレベル**: 高
- **推奨制御**: 再帰深度の制限、実行内容の監視
- **注意事項**: 無限ループや過度な処理に注意
- **使用例**: `複雑なタスクを段階的に実行`

### Bash
- **説明**: シェルコマンドの実行
- **リスクレベル**: 高
- **推奨制御**: コマンドホワイトリスト、パラメータ検証
- **注意事項**: システムコマンドの実行に最大限の注意
- **使用例**: `gitのステータスを確認`

### Edit
- **説明**: ファイルの部分的な編集
- **リスクレベル**: 中
- **推奨制御**: 編集内容のログ、重要ファイルの保護
- **使用例**: `関数の実装を修正`

### Read
- **説明**: ファイルの読み取り（Claude専用）
- **リスクレベル**: 低
- **推奨制御**: 基本的なアクセスログ
- **使用例**: `ソースコードを確認`

### Write
- **説明**: ファイルの書き込み（Claude専用）
- **リスクレベル**: 中
- **推奨制御**: 書き込み内容の検証
- **使用例**: `新しい設定ファイルを作成`

### MultiEdit
- **説明**: 複数箇所の同時編集
- **リスクレベル**: 中〜高
- **推奨制御**: 変更量の制限、バックアップ推奨
- **使用例**: `リファクタリングで複数箇所を更新`

### Glob
- **説明**: ファイルパターンマッチング
- **リスクレベル**: 低
- **推奨制御**: 検索範囲の制限
- **使用例**: `**/*.tsファイルを検索`

### Grep
- **説明**: ファイル内容の検索
- **リスクレベル**: 低
- **推奨制御**: 基本的なアクセスログ
- **使用例**: `エラーメッセージを含むファイルを検索`

### LS
- **説明**: ディレクトリ一覧（詳細版）
- **リスクレベル**: 低
- **推奨制御**: なし
- **使用例**: `プロジェクト構造を確認`

## 🌐 その他の統合ツール

### web_search
- **説明**: Web検索の実行
- **リスクレベル**: 低〜中
- **推奨制御**: 検索クエリのログ、結果のフィルタリング
- **使用例**: `最新のNode.jsドキュメントを検索`

### web_fetch
- **説明**: Webページの取得
- **リスクレベル**: 中
- **推奨制御**: URLホワイトリスト、コンテンツ検証
- **使用例**: `公式ドキュメントの内容を取得`

### artifacts
- **説明**: コード生成物の作成・管理
- **リスクレベル**: 低
- **推奨制御**: 生成内容のログ
- **使用例**: `React コンポーネントを生成`

### repl
- **説明**: ブラウザ環境でのJS実行
- **リスクレベル**: 中
- **推奨制御**: 実行コードの検証
- **使用例**: `UIコンポーネントのデモを実行`

### TodoRead / TodoWrite
- **説明**: タスク管理
- **リスクレベル**: 低
- **推奨制御**: 通常は制御対象外
- **使用例**: `現在のタスクリストを確認`

## 🎯 リスクレベル別の推奨制御

### 🟢 低リスク（読み取り系）
- **対象**: read, list, search, view系ツール
- **制御**: 
  - 基本的なアクセスログ
  - アクセス頻度の監視
  - 異常なパターンの検出

### 🟡 中リスク（書き込み系）
- **対象**: write, create, edit, modify系ツール
- **制御**:
  - 詳細な操作ログ
  - 重要ファイルの保護
  - 変更前のバックアップ推奨
  - 大量操作時の警告

### 🔴 高リスク（実行系）
- **対象**: exec, bash, shell, delete系ツール
- **制御**:
  - コマンド/コードの事前検証
  - ホワイトリスト方式の制御
  - 詳細な実行ログと監査証跡
  - 必要に応じて承認フロー
  - サンドボックス環境での実行

## 📋 ツール制御のベストプラクティス

### 1. デフォルト拒否の原則
```javascript
// aegis-mcp-config.json
{
  "proxySettings": {
    "policyControl": {
      "defaultEnabled": true,
      "defaultDecision": "DENY"
    }
  }
}
```

### 2. 必要最小限の権限
- 各エージェントに必要なツールのみ許可
- 読み取り専用で十分な場合は書き込みを制限

### 3. コンテキストベースの制御
```
営業時間内: 通常の開発ツール使用可能
時間外: 読み取りとログ確認のみ
緊急時: 特別な承認で全ツール使用可能
```

### 4. 監査とモニタリング
- 全ツール使用の記録
- 異常パターンの自動検出
- 定期的なアクセスレビュー

## 🔧 カスタムツールの追加

新しいMCPツールを追加した場合：

1. ツール名からリスクレベルを自動判定
2. 適切なポリシーを適用
3. 必要に応じて個別設定を追加

```javascript
// 個別ツール設定の例
{
  "toolPolicies": {
    "my-custom-tool": {
      "enabled": true,
      "riskLevel": "medium",
      "constraints": ["ログ記録必須"],
      "obligations": ["実行後レポート"]
    }
  }
}
```

## 📚 関連ドキュメント

- [ポリシー記述ガイド](./policy-writing.md) - ツール制御ポリシーの書き方
- [実践的な使用例](./examples.md) - 具体的な制御シナリオ
- [MCP統合詳細](../developer-guide/mcp-integration.md) - 技術的な実装詳細