# Claude Codeへの指示におけるベストプラクティス

## 1. 指示の具体性 (Provide Specificity and Context)

*   **目的:** Claudeに正確な実装をさせるため、曖昧さを排除し、必要な情報をすべて与える。
*   **アクション:**
    *   関連するファイル名を明示する (`src/policy/hybrid-policy-engine.ts`など)。
    *   参照すべきドキュメントやライブラリのURLを提示する。
    *   UIの変更を伴う場合は、デザインのスクリーンショットやワイヤーフレームを提供する。
    *   エラーメッセージやログが出力されている場合は、その全文を正確に伝える。

## 2. 計画駆動型アプローチ (Plan-Driven Development)

*   **目的:** 複雑なタスクや広範囲に影響する変更を、場当たり的ではなく計画的に進めることで、手戻りを防ぎ、品質を確保する。
*   **アクション:**
    1.  **調査と計画:** まず「実装計画を立てて」と指示する。`grep`や`find`、`ls`などのコマンドを使わせて、影響範囲を特定させる。
    2.  **計画のレビュー:** Claudeが提示した計画（変更対象のファイルリスト、修正内容の概要など）を人間がレビューし、承認または修正する。
    3.  **実装:** 承認された計画に基づき、具体的な実装を指示する。

## 3. タスクの管理と軌道修正 (Task Management and Course Correction)

*   **目的:** 大規模なタスクや長期間にわたるタスクでも、進捗を可視化し、道筋から外れないように導く。
*   **アクション:**
    *   `TODO.md`やチェックリストファイルを作成させ、タスクの完了状況を追跡させる。
    *   Claudeの出力が期待と異なる場合は、即座に停止させ、軌道修正のための追加情報や指示を与える。
    *   一度にすべての変更をさせず、論理的な単位（例：「まずコアロジックを修正し、次にテストを修正する」）で分割して指示する。

## 4. 履歴管理とコンテキストの永続化 (History Management and Context Persistence)

*   **目的:** 過去の議論や決定事項、指示内容を正確に記録・参照し、一貫性のあるタスク実行を保証する。
*   **アクション:**
    *   **`history-mcp`ツールの活用:** 会話の重要なマイルストーン（タスクの計画、ユーザーからの重要な指示、実装のサマリーなど）は、`history-mcp`ツール（`save_conversation`）を使用して永続化する。
    *   **コンテキストの参照:** 新しいタスクを開始する際や、過去の経緯を確認する必要がある場合は、`history-mcp`ツール（`search_conversations`, `get_conversation`）で関連する履歴を検索・参照し、その内容をClaudeへの指示に含める。